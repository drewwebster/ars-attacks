<html>

<head>
  <meta charset="utf-8">
  <title>ARs Attacks!</title>
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  <script src="https://unpkg.com/networked-aframe/dist/networked-aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-randomizer-components@^3.0.1/dist/aframe-randomizer-components.min.js"></script>
  <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.1.2/dist/aframe-physics-system.min.js"></script>
  <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>
  <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
  <script src="js/aframe-state-component.js"></script>
  <script src="/js/spawn-in-circle.component.js"></script>
  <script src="/js/game-state.js"></script>
  <script src="./js/projectile.js"></script>
  <script src="./js/shooter.js"></script>
  <script src="./js/target.js"></script>
  <script src="./js/oculus-go-controls.js"></script>
  <script src="/js/html-imports.min.js"></script>
  <link rel="import" href="templates.html">
</head>

<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js"></script>
  <script src="/easyrtc/easyrtc.js"></script>
  <a-scene networked-scene="
      room: dev;
      debug: true;
      adapter: wseasyrtc;
     "
    environment="preset:yavapai" 
    physics="gravity: 0">
    <a-assets>
      <a-mixin id="projectile-mixin" geometry="primitive: sphere; radius: 0.05" 
               collision-filter="group: projectiles; collidesWith: players, default">
      </a-mixin>
      <a-mixin id="controller-mixin" shooter></a-mixin>
      <a-asset-item id="alien" src="/assets/atat-alien/scene.gltf"></a-asset-item>
      <a-asset-item id="ufo" src="/assets/low-poly-ufo/scene.gltf"></a-asset-item>
      <a-asset-item id="base" src="/assets/base/scene.gltf"></a-asset-item>
      <a-asset-item id="man-in-black" src="/assets/man-in-black/scene.gltf"></a-asset-item>
    </a-assets>
    <!-- <a-entity gltf-model="#alien" position="0 -2 -1" scale="0.25 0.25 0.25"></a-entity>
    <a-entity gltf-model="#ufo" scale="0.05 0.05 0.05"></a-entity> -->
    <a-entity gltf-model="#base" scale="5 5 5"></a-entity>
    <!-- <a-entity gltf-model="#man-in-black"></a-entity> -->

    <a-entity id="player" networked="template:#avatar-template;attachTemplateToLocal:false;" camera spawn-in-circle="radius:3"
      position="0 1.6 0"
      wasd-controls look-controls
      shooter target
      static-body="shape: sphere; sphereRadius: 0.5" physics-collider="ignoreSleep: true"
      collision-filter="group: players; collidesWith: projectiles; collisionForces: false">
      <a-sphere class="head" visible="false" random-color></a-sphere>
    </a-entity>
    <a-entity class="right-controller" mixin="controller-mixin"
       daydream-controls="hand: right" gearvr-controls="hand: right"
       oculus-touch-controls="hand: right" vive-controls="hand: right"
       windows-motion-controls="hand: right" oculus-go-controls="hand: right">
    </a-entity>
      <a-entity class="left-controller" mixin="controller-mixin"
       oculus-touch-controls="hand: left" vive-controls="hand: left"
       windows-motion-controls="hand: left">
    </a-entity>

    <a-entity text="side: double; width: 10; wrapCount: 20;" position="3.2 3 -5.14" bind__text="value: life;"></a-entity>

    <a-entity position="0 0 0" geometry="primitive: plane; width: 10000; height: 10000;" rotation="-90 0 0" material="visible:false"
      static-body collision-filter="collidesWith: projectiles"></a-entity>

    <a-entity light="color: #ccccff; intensity: 1; type: ambient;" visible=""></a-entity>
    <a-entity light="color: #ffaaff; intensity: 1.5" position="5 5 5"></a-entity>

    <a-sky src="#sky" rotation="0 -90 0"></a-sky>
  </a-scene>
  <script src="js/naf-templates-schemas.js"></script>
  <script>
    // Called by Networked-Aframe when connected to server
    function onConnect() {
      console.log("onConnect", new Date());
    }

    function increasePointsExample() {
      AFRAME.scenes[0].emit('increaseScore', { points: 50 });
    }
  </script>
 </body>

</html>